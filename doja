-- ===============================
-- ğŸ® à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹€à¸¥à¹ˆà¸™à¹€à¸à¸¡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´
-- ===============================
local function runGameCycle()
    ChooseMode()
    task.wait(5)

    -- ğŸŸ¢ à¸§à¸²à¸‡ raff à¹à¸šà¸šà¸ªà¸¸à¹ˆà¸¡à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡
    local pos1 = placeRaff1()
    print("ğŸ“Œ raff1 à¸§à¸²à¸‡à¸—à¸µà¹ˆ:", tostring(pos1))
    local id1 = placeUnitSafe(pos1, 1)
    print("ğŸ†” raff1 ID:", id1)

    task.wait(13)

    local pos2 = placeRaff2()
    print("ğŸ“Œ raff2 à¸§à¸²à¸‡à¸—à¸µà¹ˆ:", tostring(pos2))
    local id2 = placeUnitSafe(pos2, 2)
    print("ğŸ†” raff2 ID:", id2)

    task.wait(69)

    local pos3 = placeRaff3()
    print("ğŸ“Œ raff3 à¸§à¸²à¸‡à¸—à¸µà¹ˆ:", tostring(pos3))
    local id3 = placeUnitSafe(pos3, 1)
    print("ğŸ†” raff3 ID:", id3)

    -- ğŸ’° à¸­à¸±à¸›à¹€à¸à¸£à¸”à¸¢à¸¹à¸™à¸´à¸•à¸•à¸²à¸¡à¹€à¸‡à¸´à¸™
    waitUntilCash(8000)
    upgradeUnitById(id3)
    task.wait(30)
    waitUntilCash(8000)
    upgradeUnitById(id2)
end

-- ===============================
-- ğŸ” à¸§à¸™à¸¥à¸¹à¸›à¸£à¸­à¹€à¸à¸¡à¸ˆà¸šà¸à¹ˆà¸­à¸™à¹€à¸£à¸´à¹ˆà¸¡à¸£à¸­à¸šà¹ƒà¸«à¸¡à¹ˆ
-- ===============================
local gameEndedEvent = Instance.new("BindableEvent")

-- à¹€à¸¡à¸·à¹ˆà¸­à¹€à¸à¸¡à¸ˆà¸š à¹ƒà¸«à¹‰à¸ªà¹ˆà¸‡à¸ªà¸±à¸à¸à¸²à¸“
ReplicatedStorage.RemoteEvents.ShowGameEnd.OnClientEvent:Connect(function()
    task.wait(2)
    again() -- à¸£à¸µà¸ªà¸•à¸²à¸£à¹Œà¸—à¹€à¸à¸¡
    gameEndedEvent:Fire() -- à¹à¸ˆà¹‰à¸‡à¸§à¹ˆà¸²à¸„à¸§à¸£à¹€à¸£à¸´à¹ˆà¸¡à¸£à¸­à¸šà¹ƒà¸«à¸¡à¹ˆ
end)

-- à¹€à¸£à¸´à¹ˆà¸¡à¸¥à¸¹à¸›à¸£à¸­à¸šà¹ƒà¸«à¸¡à¹ˆà¸«à¸¥à¸±à¸‡à¹€à¸à¸¡à¸ˆà¸š
while true do
    gameEndedEvent.Event:Wait() -- à¸£à¸­à¹ƒà¸«à¹‰à¹€à¸à¸¡à¸ˆà¸š + à¸£à¸µà¸ªà¸•à¸²à¸£à¹Œà¸—
    runGameCycle()
end
