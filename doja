local gameRunning = true

local function mainScript()
    gameRunning = true

    -- ğŸš€ à¹€à¸£à¸´à¹ˆà¸¡à¹€à¸à¸¡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´
    ChooseMode()
    task.wait(5)
    if not gameRunning then return end

    -- ğŸŸ¢ à¸§à¸²à¸‡ raff à¹à¸šà¸šà¸ªà¸¸à¹ˆà¸¡à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡
    local pos1 = placeRaff1()
    print("ğŸ“Œ raff1 à¸§à¸²à¸‡à¸—à¸µà¹ˆ:", tostring(pos1))
    local id1 = placeUnitSafe(pos1, 1)
    print("ğŸ†” raff1 ID:", id1)
    if not gameRunning then return end

    task.wait(13)
    local pos2 = placeRaff2()
    print("ğŸ“Œ raff2 à¸§à¸²à¸‡à¸—à¸µà¹ˆ:", tostring(pos2))
    local id2 = placeUnitSafe(pos2, 2)
    print("ğŸ†” raff2 ID:", id2)
    if not gameRunning then return end

    task.wait(69)
    local pos3 = placeRaff3()
    print("ğŸ“Œ raff3 à¸§à¸²à¸‡à¸—à¸µà¹ˆ:", tostring(pos3))
    local id3 = placeUnitSafe(pos3, 1)
    print("ğŸ†” raff3 ID:", id3)
    if not gameRunning then return end

    -- ğŸ’° à¸­à¸±à¸›à¹€à¸à¸£à¸”à¸¢à¸¹à¸™à¸´à¸•à¸•à¸²à¸¡à¹€à¸‡à¸´à¸™
    waitUntilCash(8000)
    if not gameRunning then return end
    upgradeUnitById(id3)
    task.wait(30)
    if not gameRunning then return end
    waitUntilCash(8000)
    if not gameRunning then return end
    upgradeUnitById(id2)
end

-- ğŸ”” à¹€à¸¡à¸·à¹ˆà¸­à¹€à¸à¸¡à¸ˆà¸š
ReplicatedStorage.RemoteEvents.ShowGameEnd.OnClientEvent:Connect(function()
    gameRunning = false  -- à¸«à¸¢à¸¸à¸” task à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™
    task.wait(0.5)
    again()               -- à¸£à¸µà¸ªà¸•à¸²à¸£à¹Œà¸—à¹€à¸à¸¡à¹€à¸«à¸¡à¸·à¸­à¸™à¹€à¸”à¸´à¸¡
    task.wait(1)
    task.spawn(mainScript)  -- à¹€à¸£à¸´à¹ˆà¸¡à¸ªà¸„à¸£à¸´à¸›à¸•à¹Œà¹ƒà¸«à¸¡à¹ˆà¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
end)

-- à¹€à¸£à¸´à¹ˆà¸¡à¸ªà¸„à¸£à¸´à¸›à¸•à¹Œà¸„à¸£à¸±à¹‰à¸‡à¹à¸£à¸
task.spawn(mainScript)
