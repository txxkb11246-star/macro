-- ===============================
-- Universal Button Clicker
-- ===============================

local VIM = game:GetService("VirtualInputManager")

local function clickButtonAuto(button)
    if not button or not button:IsA("GuiButton") then
        warn("Invalid button")
        return false
    end

    -- 1) getconnections ทุก event
    local events = {
        "Activated",
        "MouseButton1Click",
        "MouseButton1Down",
        "MouseButton1Up"
    }

    for _, ev in ipairs(events) do
        local signal = button[ev]
        if signal then
            local conns = getconnections(signal)
            if #conns > 0 then
                print("✅ click via getconnections:", ev)
                for _, c in ipairs(conns) do
                    if c.Function then
                        pcall(c.Function)
                    end
                end
                return true
            end
        end
    end

    -- 2) firesignal (ถ้า executor รองรับ)
    for _, ev in ipairs(events) do
        local signal = button[ev]
        if signal then
            local ok = pcall(function()
                firesignal(signal)
            end)
            if ok then
                print("✅ click via firesignal:", ev)
                return true
            end
        end
    end

    -- 3) VirtualInputManager (ไม้ตาย)
    print("⚠️ fallback to VirtualInputManager")

    local pos = button.AbsolutePosition
    local size = button.AbsoluteSize

    local x = pos.X + size.X / 2
    local y = pos.Y + size.Y / 2

    VIM:SendMouseButtonEvent(x, y, 0, true, game, 0)
    task.wait(0.05)
    VIM:SendMouseButtonEvent(x, y, 0, false, game, 0)

    return true
end
