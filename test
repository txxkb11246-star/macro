-- =====================================
-- Auto Select + Equip Rafflesia (All-in-One)
-- =====================================

local Players = game:GetService("Players")
local VIM = game:GetService("VirtualInputManager")
local player = Players.LocalPlayer
local PlayerGui = player:WaitForChild("PlayerGui")

-- ---------- Utils ----------
local function clickGui(gui)
    if not gui then return end
    local pos = gui.AbsolutePosition
    local size = gui.AbsoluteSize
    local x = pos.X + size.X / 2
    local y = pos.Y + size.Y / 2
    VIM:SendMouseButtonEvent(x, y, 0, true, game, 0)
    task.wait(0.05)
    VIM:SendMouseButtonEvent(x, y, 0, false, game, 0)
end

local function waitForGameGui()
    local gg
    repeat
        task.wait()
        gg = PlayerGui:FindFirstChild("GameGui", true)
    until gg
    return gg
end

local function findInventoryScrollingFrame(GameGui)
    for _, v in ipairs(GameGui:GetDescendants()) do
        if v:IsA("ScrollingFrame") then
            return v
        end
    end
end

-- ---------- Main ----------
local TARGET = "rafflesia"

local GameGui = waitForGameGui()
local scroll = findInventoryScrollingFrame(GameGui)

if not scroll then
    warn("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö Inventory (ScrollingFrame) ‚Äî ‡πÄ‡∏õ‡∏¥‡∏î Inventory ‡∏Å‡πà‡∏≠‡∏ô")
    return
end

print("‚úÖ Inventory found")

-- 1) ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ï‡∏±‡∏ß unit (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)
local clickedItem = false
for _, item in ipairs(scroll:GetChildren()) do
    if item:IsA("Frame") then
        for _, obj in ipairs(item:GetDescendants()) do
            if obj:IsA("TextLabel")
            and string.lower(obj.Text):find(TARGET) then
                print("üéØ Found unit:", obj.Text)
                clickGui(item)
                clickedItem = true
                break
            end
        end
        if clickedItem then break end
    end
end

if not clickedItem then
    warn("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö rafflesia ‡πÉ‡∏ô Inventory")
    return
end

-- 2) ‡∏£‡∏≠ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Equip ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ (‡∏ö‡∏≤‡∏á‡πÄ‡∏Å‡∏° auto-equip)
task.wait(0.25)

local equipButton
for _, v in ipairs(GameGui:GetDescendants()) do
    if v:IsA("GuiButton")
    and v.Visible
    and (
        string.lower(v.Name):find("equip")
        or (v:FindFirstChildWhichIsA("TextLabel") and string.lower(v:FindFirstChildWhichIsA("TextLabel").Text):find("equip"))
    ) then
        equipButton = v
        break
    end
end

if equipButton then
    print("üü¢ Click Equip")
    clickGui(equipButton)
else
    print("‚ÑπÔ∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏∏‡πà‡∏° Equip (‡πÄ‡∏Å‡∏°‡∏ô‡∏µ‡πâ equip ‡∏ï‡∏≠‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å item)")
end

print("‚úÖ Done")
